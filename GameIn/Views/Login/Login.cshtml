@model GameIn.Models.Users

@{
    ViewBag.Title = Resources.Resources.Login;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Ajax.BeginForm("Login", new AjaxOptions { OnBegin = "onbegin", OnSuccess = "onsuccess", UpdateTargetId = "updateME" }))
{
    @Html.AntiForgeryToken()
    <fieldset class="fs_container">
        <legend>@Resources.Resources.Login</legend>
        <div class="divRow">
            <div class="editor-label">
                @Html.LabelFor(model => model.UserName)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.UserName)
                @Html.ValidationMessageFor(model => model.UserName)
            </div>
        </div>

        <div class="divRow">
            <div class="editor-label">
                @Html.LabelFor(model => model.Password)
            </div>
            <div class="editor-field">
                @Html.PasswordFor(model => model.Password)
                @Html.ValidationMessageFor(model => model.Password)
            </div>
        </div>
        <p>
            <input id="btn_Register" type="submit" value="@Resources.Resources.Login" />
        </p>
        <div id="updateME" align="center"></div>
        <div id="loader" align="center"><img class="ajaxLoader" /></div>
        <br />
    </fieldset>
}

@Html.Hidden("hf_lang", HttpContext.Current.Request.RequestContext.RouteData.Values["Lang"] != null
            ? HttpContext.Current.Request.RequestContext.RouteData.Values["Lang"].ToString() : "")
<div>
    @Html.ActionLink(Resources.Resources.Back, "Home", "Login",
        new
        {
            lang = HttpContext.Current.Request.RequestContext.RouteData.Values["Lang"] != null
                ? HttpContext.Current.Request.RequestContext.RouteData.Values["Lang"].ToString() : ""
        }, null)
</div>

@section Scripts
{
<script>
function onbegin() {
    $(".ajaxLoader").css("display", "block");
}
function onsuccess(result) {
    if (result.url) { window.location.href = result.url }
    $(".ajaxLoader").css("display", "none");
}
</script>
}